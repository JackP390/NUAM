{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mi Panel | NUAM</title>
    <link rel="stylesheet" href="{% static 'css/admin.css' %}">
</head>
<body>

    <nav class="sidebar">
        <div class="sidebar-header">
            <img src="{% static 'images/Nuam_logo-transparente.png' %}" alt="Nuam Logo" class="sidebar-logo">
            <p style="margin-top:10px; font-size: 0.9em; color: #ccc;">Panel de Corredor</p>
        </div>
        
        <ul class="nav-links">
            <li class="nav-item active" onclick="showSection('mis_clientes', this)">
                <span>ðŸ“‚ Mis Clientes</span>
            </li>
            </ul>

        <div class="logout-link">
            <a href="{% url 'main' %}">Cerrar SesiÃ³n</a> 
        </div>
    </nav>

    <main class="main-content">
        
        <div class="card" style="margin-bottom: 20px; border-left: 5px solid #ff4403;">
            <h2 style="border:none; margin:0; padding:0;">Hola, {{ nombre_e }}</h2>
            <p style="color: #666; margin-top: 5px;">Bienvenido a tu gestor de cartera.</p>
        </div>

        <div id="mis_clientes" class="section-container active-section">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>Cartera de Clientes</h2>
                    <a href="{% url 'create_client' %}" id="boton" style="text-decoration:none; padding: 10px 20px; width: auto; margin:0;">+ Nuevo Cliente</a>
                </div>

                <input type="search" placeholder="Buscar por RUT o Nombre..." class="campo" style="width: 100%; margin-bottom: 20px; padding: 10px;">

                <table class="info">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>RUT</th>
                            <th>Email</th>
                            <th>TelÃ©fono</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for cliente in clientes %}
                        <tr>
                            <td>{{ cliente.nombre }}</td>
                            <td>{{ cliente.rut }}</td>
                            <td>{{ cliente.email }}</td>
                            <td>{{ cliente.telefono }}</td>
                            <td>
                                <a href="{% url 'modify_client' cliente.id %}" class="btn-toggle" style="background:#e3f2fd; color:#0d47a1;">Editar</a>
                                
                                <form method="POST" action="{% url 'delete_client' cliente.id %}" style="display:inline;" onsubmit="return confirm('Â¿Borrar cliente?');">
                                    {% csrf_token %}
                                    <button type="submit" class="btn-toggle" style="background:none; color:red; border:none; cursor:pointer; text-decoration:underline;">Eliminar</button>
                                </form>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" style="text-align:center; padding: 30px; color: #999;">
                                No tienes clientes asociados aÃºn. Â¡Crea el primero!
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

    </main>

    <script>
        // Reutilizamos el script de pestaÃ±as
        function showSection(sectionId, element) {
            document.querySelectorAll('.section-container').forEach(div => div.classList.remove('active-section'));
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active-section');
            element.classList.add('active');
        }
    </script>

</body>
</html>